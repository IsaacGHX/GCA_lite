2025-04-15 15:53:08,861  INFO  ARGS = {
  "notes": "回测工商银行",
  "data_path": "database/process_工商银行.csv",
  "output_dir": "out_put/multi",
  "ckpt_dir": "ckpt",
  "feature_columns": [
    2,
    3,
    4,
    5,
    6,
    7,
    8,
    9,
    10,
    11,
    12,
    13,
    14,
    15,
    16,
    17,
    18,
    19,
    20,
    21,
    22,
    23,
    1
  ],
  "target_columns": [
    [
      1
    ]
  ],
  "start_timestamp": 1,
  "end_timestamp": 2400,
  "window_sizes": [
    5,
    10,
    15
  ],
  "N_pairs": 3,
  "num_classes": 3,
  "generators": [
    "gru",
    "lstm",
    "transformer"
  ],
  "discriminators": null,
  "distill_epochs": 1,
  "cross_finetune_epochs": 5,
  "device": [
    0
  ],
  "num_epochs": 10000,
  "lr": 2e-05,
  "batch_size": 64,
  "train_split": 0.7,
  "random_seed": 3407,
  "amp_dtype": "none",
  "mode": "train",
  "ckpt_path": "lastest"
}
2025-04-15 15:53:10,649  INFO  Do distill 1 epoch! Distill from G3 to G2
2025-04-15 15:53:11,265  INFO  == Cross finetune Epoch [1/10000]: G3: Validation MSE 0.00305154
2025-04-15 15:53:11,707  INFO  == Cross finetune Epoch [2/10000]: G3: Validation MSE 0.00182038
2025-04-15 15:53:12,099  INFO  == Cross finetune Epoch [3/10000]: G3: Validation MSE 0.00104098
2025-04-15 15:53:12,485  INFO  == Cross finetune Epoch [4/10000]: G3: Validation MSE 0.00091211
2025-04-15 15:53:12,928  INFO  == Cross finetune Epoch [5/10000]: G3: Validation MSE 0.00158310
2025-04-15 15:53:12,928  INFO  EPOCH 1 | Validation MSE: G1: 0.06853627, G2: 0.06894848, G3: 0.00804503 
2025-04-15 15:53:14,451  INFO  EPOCH 2 | Validation MSE: G1: 0.05156858, G2: 0.06037040, G3: 0.00092998 
2025-04-15 15:53:15,828  INFO  EPOCH 3 | Validation MSE: G1: 0.03757701, G2: 0.05317567, G3: 0.00068401 
2025-04-15 15:53:17,299  INFO  EPOCH 4 | Validation MSE: G1: 0.02637718, G2: 0.04663233, G3: 0.00057890 
2025-04-15 15:53:18,932  INFO  EPOCH 5 | Validation MSE: G1: 0.01823366, G2: 0.04080735, G3: 0.00054795 
2025-04-15 15:53:20,408  INFO  EPOCH 6 | Validation MSE: G1: 0.01306281, G2: 0.03560102, G3: 0.00095063 
2025-04-15 15:53:21,816  INFO  EPOCH 7 | Validation MSE: G1: 0.01043027, G2: 0.03097392, G3: 0.00130809 
2025-04-15 15:53:23,306  INFO  EPOCH 8 | Validation MSE: G1: 0.00952747, G2: 0.02711360, G3: 0.00044227 
2025-04-15 15:53:24,697  INFO  EPOCH 9 | Validation MSE: G1: 0.00934681, G2: 0.02426313, G3: 0.00037332 
2025-04-15 15:53:26,203  INFO  EPOCH 10 | Validation MSE: G1: 0.00919366, G2: 0.02240943, G3: 0.00042404 
2025-04-15 15:53:27,640  INFO  Do distill 1 epoch! Distill from G3 to G2
2025-04-15 15:53:28,247  INFO  == Cross finetune Epoch [1/10000]: G3: Validation MSE 0.00034054
2025-04-15 15:53:28,737  INFO  == Cross finetune Epoch [2/10000]: G3: Validation MSE 0.00050573
2025-04-15 15:53:29,169  INFO  == Cross finetune Epoch [3/10000]: G3: Validation MSE 0.00036453
2025-04-15 15:53:29,615  INFO  == Cross finetune Epoch [4/10000]: G3: Validation MSE 0.00080266
2025-04-15 15:53:30,055  INFO  == Cross finetune Epoch [5/10000]: G3: Validation MSE 0.00158503
2025-04-15 15:53:30,056  INFO  EPOCH 11 | Validation MSE: G1: 0.00883784, G2: 0.02166697, G3: 0.00054531 
2025-04-15 15:53:31,545  INFO  EPOCH 12 | Validation MSE: G1: 0.00835880, G2: 0.02194026, G3: 0.00028959 
2025-04-15 15:53:32,958  INFO  EPOCH 13 | Validation MSE: G1: 0.00772328, G2: 0.02271200, G3: 0.00037191 
2025-04-15 15:53:34,413  INFO  EPOCH 14 | Validation MSE: G1: 0.00716542, G2: 0.02380642, G3: 0.00049869 
2025-04-15 15:53:35,842  INFO  EPOCH 15 | Validation MSE: G1: 0.00660394, G2: 0.02426661, G3: 0.00031411 
2025-04-15 15:53:37,210  INFO  EPOCH 16 | Validation MSE: G1: 0.00601999, G2: 0.02400435, G3: 0.00042737 
2025-04-15 15:53:38,586  INFO  EPOCH 17 | Validation MSE: G1: 0.00552614, G2: 0.02353867, G3: 0.00031577 
2025-04-15 15:53:40,012  INFO  EPOCH 18 | Validation MSE: G1: 0.00494684, G2: 0.02197527, G3: 0.00047371 
2025-04-15 15:53:41,521  INFO  EPOCH 19 | Validation MSE: G1: 0.00442376, G2: 0.02037177, G3: 0.00056938 
2025-04-15 15:53:43,117  INFO  EPOCH 20 | Validation MSE: G1: 0.00398527, G2: 0.01862814, G3: 0.00034505 
2025-04-15 15:53:44,945  INFO  Do distill 1 epoch! Distill from G3 to G2
2025-04-15 15:53:45,672  INFO  == Cross finetune Epoch [1/10000]: G3: Validation MSE 0.00053489
2025-04-15 15:53:46,200  INFO  == Cross finetune Epoch [2/10000]: G3: Validation MSE 0.00056733
2025-04-15 15:53:46,758  INFO  == Cross finetune Epoch [3/10000]: G3: Validation MSE 0.00036155
2025-04-15 15:53:47,312  INFO  == Cross finetune Epoch [4/10000]: G3: Validation MSE 0.00039968
2025-04-15 15:53:47,843  INFO  == Cross finetune Epoch [5/10000]: G3: Validation MSE 0.00043278
2025-04-15 15:53:47,843  INFO  EPOCH 21 | Validation MSE: G1: 0.00354113, G2: 0.01654380, G3: 0.00072718 
2025-04-15 15:53:49,748  INFO  EPOCH 22 | Validation MSE: G1: 0.00320642, G2: 0.01536347, G3: 0.00049515 
2025-04-15 15:53:51,203  INFO  EPOCH 23 | Validation MSE: G1: 0.00281075, G2: 0.01386490, G3: 0.00045149 
2025-04-15 15:53:52,815  INFO  EPOCH 24 | Validation MSE: G1: 0.00255982, G2: 0.01323379, G3: 0.00042782 
2025-04-15 15:53:54,343  INFO  EPOCH 25 | Validation MSE: G1: 0.00218095, G2: 0.01161472, G3: 0.00038006 
2025-04-15 15:53:55,771  INFO  EPOCH 26 | Validation MSE: G1: 0.00196844, G2: 0.01044901, G3: 0.00045874 
2025-04-15 15:53:57,487  INFO  EPOCH 27 | Validation MSE: G1: 0.00172587, G2: 0.00970723, G3: 0.00085233 
2025-04-15 15:53:59,271  INFO  EPOCH 28 | Validation MSE: G1: 0.00153821, G2: 0.00860400, G3: 0.00156701 
2025-04-15 15:54:01,078  INFO  EPOCH 29 | Validation MSE: G1: 0.00131695, G2: 0.00714131, G3: 0.00059911 
2025-04-15 15:54:02,859  INFO  EPOCH 30 | Validation MSE: G1: 0.00124617, G2: 0.00697852, G3: 0.00043806 
2025-04-15 15:54:04,683  INFO  Do distill 1 epoch! Distill from G3 to G2
2025-04-15 15:54:05,311  INFO  == Cross finetune Epoch [1/10000]: G3: Validation MSE 0.00035080
2025-04-15 15:54:05,778  INFO  == Cross finetune Epoch [2/10000]: G3: Validation MSE 0.00035207
2025-04-15 15:54:06,240  INFO  == Cross finetune Epoch [3/10000]: G3: Validation MSE 0.00034323
2025-04-15 15:54:06,679  INFO  == Cross finetune Epoch [4/10000]: G3: Validation MSE 0.00036482
2025-04-15 15:54:07,130  INFO  == Cross finetune Epoch [5/10000]: G3: Validation MSE 0.00033410
2025-04-15 15:54:07,131  INFO  EPOCH 31 | Validation MSE: G1: 0.00108341, G2: 0.00561604, G3: 0.00046614 
2025-04-15 15:54:08,626  INFO  EPOCH 32 | Validation MSE: G1: 0.00096946, G2: 0.00548819, G3: 0.00037691 
2025-04-15 15:54:10,035  INFO  EPOCH 33 | Validation MSE: G1: 0.00088868, G2: 0.00438414, G3: 0.00036159 
2025-04-15 15:54:12,021  INFO  EPOCH 34 | Validation MSE: G1: 0.00080812, G2: 0.00370113, G3: 0.00034930 
2025-04-15 15:54:13,897  INFO  EPOCH 35 | Validation MSE: G1: 0.00077154, G2: 0.00342520, G3: 0.00038738 
2025-04-15 15:54:15,517  INFO  EPOCH 36 | Validation MSE: G1: 0.00070191, G2: 0.00295823, G3: 0.00033332 
2025-04-15 15:54:17,144  INFO  EPOCH 37 | Validation MSE: G1: 0.00067849, G2: 0.00267568, G3: 0.00036354 
2025-04-15 15:54:18,801  INFO  EPOCH 38 | Validation MSE: G1: 0.00061712, G2: 0.00225052, G3: 0.00032872 
2025-04-15 15:54:20,399  INFO  EPOCH 39 | Validation MSE: G1: 0.00060425, G2: 0.00223686, G3: 0.00034403 
2025-04-15 15:54:22,018  INFO  EPOCH 40 | Validation MSE: G1: 0.00056354, G2: 0.00193553, G3: 0.00034542 
2025-04-15 15:54:23,651  INFO  Do distill 1 epoch! Distill from G3 to G2
2025-04-15 15:54:24,273  INFO  == Cross finetune Epoch [1/10000]: G3: Validation MSE 0.00034270
2025-04-15 15:54:24,732  INFO  == Cross finetune Epoch [2/10000]: G3: Validation MSE 0.00033379
2025-04-15 15:54:25,251  INFO  == Cross finetune Epoch [3/10000]: G3: Validation MSE 0.00034354
2025-04-15 15:54:25,784  INFO  == Cross finetune Epoch [4/10000]: G3: Validation MSE 0.00032985
2025-04-15 15:54:26,316  INFO  == Cross finetune Epoch [5/10000]: G3: Validation MSE 0.00034385
2025-04-15 15:54:26,317  INFO  EPOCH 41 | Validation MSE: G1: 0.00055839, G2: 0.00193650, G3: 0.00042789 
2025-04-15 15:54:28,039  INFO  EPOCH 42 | Validation MSE: G1: 0.00054109, G2: 0.00170474, G3: 0.00033961 
2025-04-15 15:54:29,691  INFO  EPOCH 43 | Validation MSE: G1: 0.00052950, G2: 0.00178954, G3: 0.00034786 
2025-04-15 15:54:31,494  INFO  EPOCH 44 | Validation MSE: G1: 0.00050460, G2: 0.00148043, G3: 0.00041034 
2025-04-15 15:54:33,201  INFO  EPOCH 45 | Validation MSE: G1: 0.00049709, G2: 0.00154526, G3: 0.00033122 
2025-04-15 15:54:34,961  INFO  EPOCH 46 | Validation MSE: G1: 0.00049216, G2: 0.00154532, G3: 0.00034588 
2025-04-15 15:54:37,361  INFO  EPOCH 47 | Validation MSE: G1: 0.00047896, G2: 0.00147487, G3: 0.00034021 
2025-04-15 15:54:39,125  INFO  EPOCH 48 | Validation MSE: G1: 0.00047355, G2: 0.00131679, G3: 0.00033458 
2025-04-15 15:54:40,722  INFO  EPOCH 49 | Validation MSE: G1: 0.00046997, G2: 0.00136308, G3: 0.00033330 
2025-04-15 15:54:42,246  INFO  EPOCH 50 | Validation MSE: G1: 0.00045976, G2: 0.00131672, G3: 0.00033111 
2025-04-15 15:54:43,888  INFO  Do distill 1 epoch! Distill from G3 to G2
2025-04-15 15:54:44,559  INFO  == Cross finetune Epoch [1/10000]: G3: Validation MSE 0.00033101
2025-04-15 15:54:45,024  INFO  == Cross finetune Epoch [2/10000]: G3: Validation MSE 0.00032998
2025-04-15 15:54:45,519  INFO  == Cross finetune Epoch [3/10000]: G3: Validation MSE 0.00033022
2025-04-15 15:54:45,983  INFO  == Cross finetune Epoch [4/10000]: G3: Validation MSE 0.00033026
2025-04-15 15:54:46,457  INFO  == Cross finetune Epoch [5/10000]: G3: Validation MSE 0.00033386
2025-04-15 15:54:46,457  INFO  EPOCH 51 | Validation MSE: G1: 0.00045638, G2: 0.00127517, G3: 0.00033293 
2025-04-15 15:54:48,043  INFO  EPOCH 52 | Validation MSE: G1: 0.00045076, G2: 0.00135745, G3: 0.00034023 
2025-04-15 15:54:49,727  INFO  EPOCH 53 | Validation MSE: G1: 0.00044682, G2: 0.00128173, G3: 0.00034240 
2025-04-15 15:54:51,336  INFO  EPOCH 54 | Validation MSE: G1: 0.00044316, G2: 0.00129955, G3: 0.00034210 
2025-04-15 15:54:52,781  INFO  EPOCH 55 | Validation MSE: G1: 0.00044168, G2: 0.00123089, G3: 0.00034572 
2025-04-15 15:54:54,276  INFO  EPOCH 56 | Validation MSE: G1: 0.00043393, G2: 0.00119348, G3: 0.00033786 
2025-04-15 15:54:55,711  INFO  EPOCH 57 | Validation MSE: G1: 0.00044870, G2: 0.00123213, G3: 0.00034172 
2025-04-15 15:54:57,216  INFO  EPOCH 58 | Validation MSE: G1: 0.00042728, G2: 0.00122074, G3: 0.00033954 
2025-04-15 15:54:58,655  INFO  EPOCH 59 | Validation MSE: G1: 0.00042362, G2: 0.00115301, G3: 0.00034176 
2025-04-15 15:55:00,209  INFO  EPOCH 60 | Validation MSE: G1: 0.00042200, G2: 0.00117087, G3: 0.00033512 
2025-04-15 15:55:01,628  INFO  Do distill 1 epoch! Distill from G3 to G2
2025-04-15 15:55:02,275  INFO  == Cross finetune Epoch [1/10000]: G3: Validation MSE 0.00033409
2025-04-15 15:55:02,834  INFO  == Cross finetune Epoch [2/10000]: G3: Validation MSE 0.00033533
2025-04-15 15:55:03,310  INFO  == Cross finetune Epoch [3/10000]: G3: Validation MSE 0.00033542
2025-04-15 15:55:03,850  INFO  == Cross finetune Epoch [4/10000]: G3: Validation MSE 0.00033155
2025-04-15 15:55:04,382  INFO  == Cross finetune Epoch [5/10000]: G3: Validation MSE 0.00032996
2025-04-15 15:55:04,382  INFO  EPOCH 61 | Validation MSE: G1: 0.00041908, G2: 0.00120447, G3: 0.00033480 
2025-04-15 15:55:06,187  INFO  EPOCH 62 | Validation MSE: G1: 0.00041542, G2: 0.00108137, G3: 0.00033223 
2025-04-15 15:55:07,935  INFO  EPOCH 63 | Validation MSE: G1: 0.00041412, G2: 0.00117258, G3: 0.00032753 
2025-04-15 15:55:09,613  INFO  EPOCH 64 | Validation MSE: G1: 0.00040892, G2: 0.00108283, G3: 0.00032704 
2025-04-15 15:55:11,320  INFO  EPOCH 65 | Validation MSE: G1: 0.00042703, G2: 0.00118732, G3: 0.00032624 
2025-04-15 15:55:12,984  INFO  EPOCH 66 | Validation MSE: G1: 0.00040652, G2: 0.00108474, G3: 0.00032745 
2025-04-15 15:55:14,560  INFO  EPOCH 67 | Validation MSE: G1: 0.00040360, G2: 0.00107285, G3: 0.00032657 
2025-04-15 15:55:16,262  INFO  EPOCH 68 | Validation MSE: G1: 0.00041096, G2: 0.00102591, G3: 0.00032645 
2025-04-15 15:55:17,652  INFO  EPOCH 69 | Validation MSE: G1: 0.00039810, G2: 0.00110517, G3: 0.00032722 
2025-04-15 15:55:19,059  INFO  EPOCH 70 | Validation MSE: G1: 0.00039591, G2: 0.00098603, G3: 0.00032620 
2025-04-15 15:55:20,516  INFO  Do distill 1 epoch! Distill from G3 to G2
2025-04-15 15:55:21,033  INFO  == Cross finetune Epoch [1/10000]: G3: Validation MSE 0.00032574
2025-04-15 15:55:21,505  INFO  == Cross finetune Epoch [2/10000]: G3: Validation MSE 0.00032614
2025-04-15 15:55:21,969  INFO  == Cross finetune Epoch [3/10000]: G3: Validation MSE 0.00032673
2025-04-15 15:55:22,470  INFO  == Cross finetune Epoch [4/10000]: G3: Validation MSE 0.00032688
2025-04-15 15:55:22,946  INFO  == Cross finetune Epoch [5/10000]: G3: Validation MSE 0.00032618
2025-04-15 15:55:22,946  INFO  EPOCH 71 | Validation MSE: G1: 0.00039283, G2: 0.00117815, G3: 0.00032545 
2025-04-15 15:55:24,564  INFO  EPOCH 72 | Validation MSE: G1: 0.00039239, G2: 0.00098389, G3: 0.00032774 
2025-04-15 15:55:26,328  INFO  EPOCH 73 | Validation MSE: G1: 0.00039453, G2: 0.00101506, G3: 0.00032648 
2025-04-15 15:55:27,932  INFO  EPOCH 74 | Validation MSE: G1: 0.00038643, G2: 0.00094704, G3: 0.00032636 
2025-04-15 15:55:29,443  INFO  EPOCH 75 | Validation MSE: G1: 0.00038966, G2: 0.00111695, G3: 0.00032641 
2025-04-15 15:55:31,018  INFO  EPOCH 76 | Validation MSE: G1: 0.00040026, G2: 0.00098234, G3: 0.00032797 
2025-04-15 15:55:32,647  INFO  EPOCH 77 | Validation MSE: G1: 0.00037984, G2: 0.00107816, G3: 0.00032727 
2025-04-15 15:55:34,159  INFO  EPOCH 78 | Validation MSE: G1: 0.00037996, G2: 0.00093428, G3: 0.00032747 
2025-04-15 15:55:35,833  INFO  EPOCH 79 | Validation MSE: G1: 0.00037725, G2: 0.00096784, G3: 0.00032858 
2025-04-15 15:55:37,502  INFO  EPOCH 80 | Validation MSE: G1: 0.00037748, G2: 0.00091423, G3: 0.00032690 
2025-04-15 15:55:38,985  INFO  Do distill 1 epoch! Distill from G3 to G2
2025-04-15 15:55:39,595  INFO  == Cross finetune Epoch [1/10000]: G3: Validation MSE 0.00032610
2025-04-15 15:55:40,036  INFO  == Cross finetune Epoch [2/10000]: G3: Validation MSE 0.00032618
2025-04-15 15:55:40,582  INFO  == Cross finetune Epoch [3/10000]: G3: Validation MSE 0.00032588
2025-04-15 15:55:41,063  INFO  == Cross finetune Epoch [4/10000]: G3: Validation MSE 0.00032563
2025-04-15 15:55:41,570  INFO  == Cross finetune Epoch [5/10000]: G3: Validation MSE 0.00032654
2025-04-15 15:55:41,570  INFO  EPOCH 81 | Validation MSE: G1: 0.00037936, G2: 0.00088788, G3: 0.00032599 
2025-04-15 15:55:43,348  INFO  EPOCH 82 | Validation MSE: G1: 0.00037974, G2: 0.00097135, G3: 0.00032674 
2025-04-15 15:55:44,919  INFO  EPOCH 83 | Validation MSE: G1: 0.00039737, G2: 0.00095642, G3: 0.00032659 
2025-04-15 15:55:46,583  INFO  EPOCH 84 | Validation MSE: G1: 0.00037202, G2: 0.00088687, G3: 0.00032638 
2025-04-15 15:55:48,241  INFO  EPOCH 85 | Validation MSE: G1: 0.00037076, G2: 0.00087332, G3: 0.00032571 
2025-04-15 15:55:49,999  INFO  EPOCH 86 | Validation MSE: G1: 0.00036961, G2: 0.00086532, G3: 0.00032617 
2025-04-15 15:55:52,028  INFO  EPOCH 87 | Validation MSE: G1: 0.00037147, G2: 0.00090984, G3: 0.00032677 
2025-04-15 15:55:53,803  INFO  EPOCH 88 | Validation MSE: G1: 0.00038259, G2: 0.00084477, G3: 0.00032641 
2025-04-15 15:55:55,540  INFO  EPOCH 89 | Validation MSE: G1: 0.00036572, G2: 0.00083999, G3: 0.00032643 
2025-04-15 15:55:57,158  INFO  EPOCH 90 | Validation MSE: G1: 0.00037057, G2: 0.00091189, G3: 0.00032667 
2025-04-15 15:55:58,812  INFO  Do distill 1 epoch! Distill from G3 to G2
2025-04-15 15:55:59,479  INFO  == Cross finetune Epoch [1/10000]: G3: Validation MSE 0.00032736
2025-04-15 15:55:59,994  INFO  == Cross finetune Epoch [2/10000]: G3: Validation MSE 0.00032671
2025-04-15 15:56:00,476  INFO  == Cross finetune Epoch [3/10000]: G3: Validation MSE 0.00032690
2025-04-15 15:56:00,982  INFO  == Cross finetune Epoch [4/10000]: G3: Validation MSE 0.00032695
2025-04-15 15:56:01,501  INFO  == Cross finetune Epoch [5/10000]: G3: Validation MSE 0.00032733
2025-04-15 15:56:01,501  INFO  EPOCH 91 | Validation MSE: G1: 0.00036455, G2: 0.00079710, G3: 0.00032762 
2025-04-15 15:56:03,081  INFO  EPOCH 92 | Validation MSE: G1: 0.00037629, G2: 0.00083210, G3: 0.00032871 
2025-04-15 15:56:04,858  INFO  EPOCH 93 | Validation MSE: G1: 0.00036133, G2: 0.00078699, G3: 0.00032828 
2025-04-15 15:56:06,528  INFO  EPOCH 94 | Validation MSE: G1: 0.00036872, G2: 0.00085317, G3: 0.00032896 
2025-04-15 15:56:08,237  INFO  EPOCH 95 | Validation MSE: G1: 0.00035887, G2: 0.00077053, G3: 0.00032850 
2025-04-15 15:56:10,162  INFO  EPOCH 96 | Validation MSE: G1: 0.00037378, G2: 0.00078541, G3: 0.00032703 
2025-04-15 15:56:11,674  INFO  EPOCH 97 | Validation MSE: G1: 0.00035566, G2: 0.00077243, G3: 0.00032657 
